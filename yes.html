<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Yippee!</title>

  <style>
    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, Arial;
      background: #ffe6ef;
      overflow-x: hidden;
    }

    .center-wrap {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 18px;
    }

    .card {
      max-width: 900px;              /* slightly narrower */
      width: min(900px, 96vw);
      background: rgba(255,255,255,0.84);
      border-radius: 18px;
      box-shadow: 0 18px 50px rgba(0,0,0,0.18);
      padding: 18px 18px 16px;
      text-align: center;
      backdrop-filter: blur(6px);
    }

    h1 { margin: 6px 0 4px; font-size: 34px; }
    p  { margin: 0 0 10px; font-size: 18px; }

    /* Yippee button ABOVE carousel */
    .btn-row { margin: 10px 0 14px; }

    button.play {
      font-size: 16px;
      border: 0;
      padding: 10px 16px;
      border-radius: 12px;
      cursor: pointer;
      background: #ff4d88;
      color: white;
    }

    .note {
      margin-top: 6px;
      font-size: 14px;
      opacity: 0.75;
    }

    /* Carousel */
    .carousel {
      display: grid;
      grid-template-columns: 52px 1fr 52px;
      align-items: center;
      gap: 10px;
      margin: 6px auto 8px;
    }

    .viewport {
      width: 100%;
      max-width: 760px;              /* SMALLER than before */
      border-radius: 16px;
      overflow: hidden;
      position: relative;
      justify-self: center;
      box-shadow: 0 14px 40px rgba(0,0,0,0.18);
      background: transparent;
      aspect-ratio: 4 / 3;           /* dynamically overridden in JS */
    }

    .slide {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;           /* no cropping */
      display: block;
      opacity: 0;
      transition: opacity 220ms ease;
      image-orientation: from-image;
    }

    .slide.active { opacity: 1; }

    .nav {
      width: 46px;
      height: 46px;
      border-radius: 50%;
      border: 0;
      cursor: pointer;
      background: rgba(255,255,255,0.78);
      backdrop-filter: blur(6px);
      box-shadow: 0 10px 22px rgba(0,0,0,0.14);
      font-size: 30px;
      line-height: 46px;
      text-align: center;
      user-select: none;
    }

    .counter {
      margin-top: 6px;
      font-size: 14px;
      opacity: 0.75;
    }

    /* Corner cats */
    .corner {
      position: fixed;
      z-index: 5;
      width: 120px;
      height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255,255,255,0.72);
      border-radius: 16px;
      box-shadow: 0 14px 40px rgba(0,0,0,0.18);
      backdrop-filter: blur(6px);
      padding: 8px;
      pointer-events: none;
    }

    .corner img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .tl { top: 14px; left: 14px; }
    .tr { top: 14px; right: 14px; }
    .bl { bottom: 14px; left: 14px; }
    .br { bottom: 14px; right: 14px; }

    @media (max-width: 700px) {
      .viewport { max-width: 92vw; }
      h1 { font-size: 28px; }
      p { font-size: 16px; }
      .corner { width: 90px; height: 90px; }
    }
  </style>
</head>

<body>
  <!-- Corner cats (relative paths for GitHub Pages) -->
  <div class="corner tl"><img src="static/cat.gif" alt="cat"></div>
  <div class="corner tr"><img src="static/cat.gif" alt="cat"></div>
  <div class="corner bl"><img src="static/cat.gif" alt="cat"></div>
  <div class="corner br"><img src="static/cat.gif" alt="cat"></div>

  <div class="center-wrap">
    <div class="card">
      <h1>üíïYIPPEE!!!üíï</h1>
      <div class="note">See you Friday! üòÅ</div>

      <div class="btn-row">
        <button class="play" id="playBtn">More yippee! üîä</button>
        <audio id="yippee" src="static/yippee.mp3" preload="auto"></audio>
      </div>

      <div class="carousel">
        <button class="nav" id="prevBtn">‚Äπ</button>

        <!-- Slides will be injected here by JS -->
        <div class="viewport" id="viewport"></div>

        <button class="nav" id="nextBtn">‚Ä∫</button>
      </div>

      <div class="counter" id="counter"></div>
    </div>
  </div>

  <script>
    // ‚úÖ Update filenames to exactly match static/photos/
    const photoFiles = [
      "us1.jpg","us2.jpg","us3.jpg","us4.jpg","us5.jpg","us6.jpg","us7.jpg",
      "us8.jpg","us9.jpg","us10.jpg","us11.jpg","us12.jpg","us13.jpg","us14.jpg"
    ];

    const viewport = document.getElementById("viewport");
    const slides = photoFiles.map((f, i) => {
      const img = document.createElement("img");
      img.className = "slide";
      img.src = `static/photos/${f}`;
      img.alt = `photo ${i+1}`;
      viewport.appendChild(img);
      return img;
    });

    const counter = document.getElementById("counter");
    let index = 0;
    const ratios = new Array(slides.length).fill(null);

    function getRatio(i) {
      return new Promise(resolve => {
        const img = slides[i];
        if (ratios[i]) return resolve(ratios[i]);

        if (img.complete && img.naturalWidth) {
          ratios[i] = img.naturalWidth / img.naturalHeight;
          return resolve(ratios[i]);
        }

        img.addEventListener("load", () => {
          ratios[i] = img.naturalWidth / img.naturalHeight;
          resolve(ratios[i]);
        }, { once: true });

        img.addEventListener("error", () => {
          ratios[i] = 4/3;
          resolve(ratios[i]);
        }, { once: true });
      });
    }

    async function show(i) {
      slides.forEach(s => s.classList.remove("active"));
      slides[i].classList.add("active");
      counter.textContent = `${i + 1} / ${slides.length}`;
      const r = await getRatio(i);
      viewport.style.aspectRatio = `${r} / 1`;
    }

    function next() {
      index = (index + 1) % slides.length;
      show(index);
    }
    function prev() {
      index = (index - 1 + slides.length) % slides.length;
      show(index);
    }

    document.getElementById("nextBtn").addEventListener("click", next);
    document.getElementById("prevBtn").addEventListener("click", prev);

    // PC-friendly keyboard arrows
    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowRight") next();
      if (e.key === "ArrowLeft") prev();
    });

    show(index);

    // Audio
    const audio = document.getElementById("yippee");
    document.getElementById("playBtn").addEventListener("click", () => audio.play().catch(() => {}));
    window.addEventListener("load", () => audio.play().catch(() => {}));
  </script>
</body>
</html>
